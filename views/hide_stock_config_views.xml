<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Form View for Hide Stock Configuration -->
    <record id="view_hide_stock_config_form" model="ir.ui.view">
        <field name="name">hide.stock.config.form</field>
        <field name="model">hide.stock.config</field>
        <field name="arch" type="xml">
            <form string="Configuraci√≥n de Ocultaci√≥n por Stock">
                <sheet>
                    <!-- Botones principales con mejor espaciado -->
                    <div class="oe_button_box" name="button_box" style="margin-bottom: 20px;">
                        <button name="action_view_hidden_products" 
                                type="object" 
                                class="oe_stat_button" 
                                icon="fa-eye-slash">
                            <field name="products_hidden_count" widget="statinfo" 
                                   string="Productos Ocultos"/>
                        </button>
                    </div>
                    
                    <!-- Panel de acciones principales -->
                    <div style="margin-bottom: 25px; padding: 15px; border: 2px solid #e9ecef; border-radius: 8px; background-color: #f8f9fa;">
                        <h4 style="margin-bottom: 15px; color: #495057;">üöÄ Acciones R√°pidas</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                            <button name="action_update_product_visibility" 
                                    string="üîÑ Actualizar Ahora" 
                                    type="object" 
                                    class="btn btn-primary"
                                    style="min-width: 180px; margin: 5px;"
                                    confirm="¬øActualizar la visibilidad de productos ahora?"
                                    help="Ejecuta inmediatamente la actualizaci√≥n de visibilidad"/>
                            
                            <button name="action_run_analysis" 
                                    string="üìä Ejecutar An√°lisis" 
                                    type="object" 
                                    class="btn btn-info"
                                    style="min-width: 180px; margin: 5px;"
                                    help="Analiza el estado actual de stock sin hacer cambios"/>
                            
                            <button name="action_view_hidden_products" 
                                    string="üëÅÔ∏è Ver Productos Ocultos" 
                                    type="object" 
                                    class="btn btn-secondary"
                                    style="min-width: 180px; margin: 5px;"
                                    help="Ve la lista de productos actualmente ocultos"/>
                            
                            <button name="action_restore_all_products" 
                                    string="üîì Restaurar Todos" 
                                    type="object" 
                                    class="btn btn-warning"
                                    style="min-width: 180px; margin: 5px;"
                                    confirm="¬øRestaurar TODOS los productos ocultos?"
                                    help="Hace visibles todos los productos ocultos por stock"/>
                        </div>
                    </div>
                    
                    <div class="oe_title">
                        <h1>
                            <field name="website_id" options="{'no_create': True}"/>
                        </h1>
                    </div>
                    
                    <!-- Configuraci√≥n principal con espaciado mejorado -->
                    <div style="margin: 20px 0;">
                        <group>
                            <group name="basic_config" string="‚öôÔ∏è Configuraci√≥n B√°sica" style="margin-right: 20px;">
                                <field name="active"/>
                                <field name="hide_strategy" widget="radio"/>
                                <field name="smart_days_threshold" 
                                       invisible="hide_strategy != 'smart_time_based'"
                                       help="D√≠as sin stock para la estrategia inteligente (300 = 10 meses)"/>
                                <field name="custom_days_threshold" 
                                       invisible="hide_strategy != 'custom_days'"
                                       help="N√∫mero de d√≠as sin stock para considerar ocultar (ej: 30, 60, 180, 300)"/>
                            </group>
                            
                            <group name="behavior_config" string="üéØ Comportamiento" style="margin-left: 20px;">
                                <field name="hide_completely"/>
                                <field name="show_notification" 
                                       invisible="hide_completely"/>
                                <field name="auto_update"/>
                                <field name="log_changes"/>
                                <field name="last_update" readonly="1"/>
                            </group>
                        </group>
                        
                        <!-- Informaci√≥n visual del tiempo configurado -->
                        <div style="margin: 25px 0; padding: 15px; border-radius: 8px; background-color: #f1f3f4;">
                            <h4 style="margin-bottom: 15px;">‚è∞ Informaci√≥n de Configuraci√≥n de Tiempo</h4>
                            <div class="alert alert-info" invisible="hide_strategy != 'smart_time_based'" style="margin: 10px 0;">
                                <p><strong>Estrategia Inteligente:</strong> Configurada para ocultar productos sin stock por m√°s de <span style="color: #007bff; font-weight: bold;"><field name="smart_days_threshold"/> d√≠as</span></p>
                                <p><em>Puedes cambiar este valor arriba para ajustar el per√≠odo</em></p>
                            </div>
                            <div class="alert alert-success" invisible="hide_strategy != 'custom_days'" style="margin: 10px 0;">
                                <p><strong>Configuraci√≥n Personalizada:</strong> <span style="color: #28a745; font-weight: bold;"><field name="custom_days_threshold"/> d√≠as</span></p>
                                <p><strong>Ejemplos de configuraci√≥n:</strong></p>
                                <ul>
                                    <li><strong>30 d√≠as:</strong> 1 mes sin stock</li>
                                    <li><strong>90 d√≠as:</strong> 3 meses sin stock</li>
                                    <li><strong>180 d√≠as:</strong> 6 meses sin stock</li>
                                    <li><strong>300 d√≠as:</strong> 10 meses sin stock</li>
                                    <li><strong>365 d√≠as:</strong> 1 a√±o sin stock</li>
                                </ul>
                            </div>
                            <div class="alert alert-warning" invisible="hide_strategy != 'all_out_of_stock'" style="margin: 10px 0;">
                                <p><strong>‚ö†Ô∏è Advertencia:</strong> Esta estrategia oculta <strong>inmediatamente</strong> todos los productos sin stock, sin considerar tiempo.</p>
                            </div>
                        </div>
                    </div>
                    
                    <notebook style="margin-top: 20px;">
                        <page string="üö´ Excepciones" name="exceptions">
                            <div style="padding: 15px;">
                                <group>
                                    <group string="Productos Excluidos" style="margin-right: 15px;">
                                        <field name="exclude_product_ids" 
                                               widget="many2many_tags"
                                               options="{'no_create': True}"
                                               help="Productos que NUNCA se ocultar√°n"/>
                                    </group>
                                    <group string="Categor√≠as Excluidas" style="margin-left: 15px;">
                                        <field name="exclude_category_ids" 
                                               widget="many2many_tags"
                                               options="{'no_create': True}"
                                               help="Categor√≠as que NUNCA se ocultar√°n"/>
                                    </group>
                                </group>
                            </div>
                        </page>
                        
                        <page string="üìã Informaci√≥n" name="info">
                            <div style="padding: 20px;">
                                <div class="alert alert-info" role="alert">
                                        <h4>üéØ Estrategias de Ocultaci√≥n</h4>
                                    <ul>
                                        <li><strong>Todos los productos sin stock:</strong> Oculta inmediatamente cualquier producto que tenga stock 0.</li>
                                        <li><strong>Inteligente basado en tiempo:</strong> Oculta productos despu√©s del tiempo que configures (por defecto 300 d√≠as = 10 meses).</li>
                                        <li><strong>Personalizado por d√≠as:</strong> Oculta productos despu√©s del n√∫mero exacto de d√≠as que configures.</li>
                                    </ul>
                                    
                                    <h4>‚è±Ô∏è Configuraci√≥n de Tiempo Recomendada</h4>
                                    <ul>
                                        <li><strong>7-15 d√≠as:</strong> Para productos perecederos</li>
                                        <li><strong>30-60 d√≠as:</strong> Para productos de alta rotaci√≥n</li>
                                        <li><strong>90-180 d√≠as:</strong> Para productos estacionales</li>
                                        <li><strong>300+ d√≠as:</strong> Para productos especializados o de lenta rotaci√≥n</li>
                                    </ul>
                                    
                                    <h4>üîß Comportamiento</h4>
                                    <ul>
                                        <li><strong>Ocultar Completamente:</strong> Los productos no aparecen en la web en absoluto.</li>
                                        <li><strong>Mostrar Notificaci√≥n:</strong> Los productos aparecen pero marcados como "Agotado".</li>
                                    </ul>
                                    
                                    <h4>‚è∞ Automatizaci√≥n</h4>
                                    <p>Si est√° habilitada la <strong>Actualizaci√≥n Autom√°tica</strong>, el sistema ejecutar√° la evaluaci√≥n todos los d√≠as a las 2:00 AM.</p>
                                </div>
                            </div>
                        </page>
                    </notebook>
                </sheet>
                
                <div class="oe_chatter" style="margin-top: 20px;">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <!-- Tree View for Hide Stock Configuration -->
    <record id="view_hide_stock_config_tree" model="ir.ui.view">
        <field name="name">hide.stock.config.list</field>
        <field name="model">hide.stock.config</field>
        <field name="arch" type="xml">
            <list string="Configuraciones de Ocultaci√≥n por Stock">
                <field name="website_id"/>
                <field name="active" widget="boolean_toggle"/>
                <field name="hide_strategy"/>
                <field name="products_hidden_count"/>
                <field name="last_update"/>
                <button name="action_update_product_visibility" 
                        string="üîÑ" 
                        type="object" 
                        title="Actualizar visibilidad"/>
            </list>
        </field>
    </record>

    <!-- Action for Hide Stock Configuration -->
    <record id="action_hide_stock_config" model="ir.actions.act_window">
        <field name="name">Configuraci√≥n de Ocultaci√≥n por Stock</field>
        <field name="res_model">hide.stock.config</field>
        <field name="view_mode">list,form</field>
        <field name="help">
            Configura c√≥mo y cu√°ndo ocultar productos sin stock del sitio web de comercio electr√≥nico.
            
            ‚Ä¢ Estrategias flexibles para diferentes necesidades
            ‚Ä¢ Ocultaci√≥n inteligente basada en tiempo
            ‚Ä¢ Excepciones para productos espec√≠ficos
            ‚Ä¢ Actualizaci√≥n autom√°tica programada
        </field>
    </record>

    <!-- Menu Item -->
    <menuitem id="menu_hide_stock_config_root"
              name="Ocultar Sin Stock"
              parent="website.menu_website_configuration"
              sequence="50"/>

    <menuitem id="menu_hide_stock_config"
              name="Configuraci√≥n de Ocultaci√≥n"
              action="action_hide_stock_config"
              parent="menu_hide_stock_config_root"
              sequence="10"/>

</odoo>
